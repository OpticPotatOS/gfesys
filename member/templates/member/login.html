{% extends "member/modal.html" %}
{% block heading %}Log in{% endblock %}{% block okbutton%}Log in{% endblock %}
{% block content %}
	<div class="alert alert-danger login_errorlist_box" style="display: none;">
		<ul class="login_errorlist">
		</ul>
	</div>
	<form action="{% url 'register' %}" method="post" class="col-md-12 form-horizontal">
		{% csrf_token %}
		<div class="form-group field-login">
			<label for="login" class="control-label">Email</label>
			<input type="text" name="login" value="" id="login" class="form-control"  />
		</div>
		<div class="form-group field-password">
			<label for="password" class="control-label">Password</label>
			<input type="password" name="password" id="password" class="form-control"/>
		</div>	
	</form>
	<div class="clearfix"></div>
	<script type="text/javascript">
		$(function(){
			btn = $("#modal").find(".btn-primary");
			btn.unbind();
			btn.click(function() {
				form = $(this).parent().parent().find("form");
				response = $.post("{% url 'login_post' %}", form.serialize(), function(data)
				{
					errorbox = form.parent().find(".login_errorlist_box").hide();
					errorlist = form.parent().find(".login_errorlist").html("");
					
					for (i = 0; i < data.errors.length; i++) {
						errorbox.show();
						errorlist.append("<li>"+data.errors[i]+"</li>");
					}
					
					if(data.errors.length == 0)
					{
						document.location = "{% url 'index' %}";
					}
					
				}, 'json');
			});
		});
	</script>
{% endblock %}